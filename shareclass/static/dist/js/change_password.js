function control_button(){0==error_password_format&&0==error_password_same?document.getElementById("submit-button").disabled=!1:document.getElementById("submit-button").disabled=!0}function validate_password_format(){var t=$("#password").val();t.length<21&&t.length>5&&t.search(pwdRule)!=-1?($("#validate-error-password-format").text(""),error_password_format=!1):(0==t.length?$("#validate-error-password-format").text(""):$("#validate-error-password-format").text("密碼格式不符"),error_password_format=!0),control_button()}function validate_password_same(){$(document).ready(function(){$("#password").keyup(check_pwd),$("#confirm-password").keyup(check_pwd)})}function check_pwd(){var t=$("#password").val(),e=$("#confirm-password").val();t==e?($("#validate-error-password").text(""),error_password_same=!1):($("#validate-error-password").text("輸入密碼不相同"),error_password_same=!0),control_button()}function logout(){$.ajax({url:"/accounts/logout/",type:"POST",complete:function(t,e,o){200===t.status&&(window.location.href="/")}})}var error_password_format=!0,error_password_same=!0;emailRule=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,pwdRule=/^.[A-Za-z0-9]+$/,jQuery(document).ajaxSend(function(t,e,o){function r(t){var e=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),r=0;r<o.length;r++){var a=jQuery.trim(o[r]);if(a.substring(0,t.length+1)==t+"="){e=decodeURIComponent(a.substring(t.length+1));break}}return e}function a(t){var e=document.location.host,o=document.location.protocol,r="//"+e,a=o+r;return t==a||t.slice(0,a.length+1)==a+"/"||t==r||t.slice(0,r.length+1)==r+"/"||!/^(\/\/|http:|https:).*/.test(t)}function n(t){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(t)}!n(o.type)&&a(o.url)&&e.setRequestHeader("X-CSRFToken",r("csrftoken"))}),$("form").submit(function(t){t.preventDefault(),$.ajax({url:"/accounts/change_password/",type:"POST",data:{current_password:$("input[name=current_password]").val(),new_password:$("input[name=new_password]").val(),confirm_new_password:$("input[name=confirm_new_password]").val()},dataType:"json",complete:function(t,e,o){200===t.status?(alert("密碼修改成功!"),window.location.href="/accounts/login/"):(document.getElementById("error").style.display="block",document.getElementById("error").innerHTML='<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>'+t.responseText.split('"')[3],document.getElementById("form-id").reset())}})});