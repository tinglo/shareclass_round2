function control_button(){var e=document.getElementById("token").value.length;0==error_password_format&&0==error_password_same&&0!==e?document.getElementById("submit-button").disabled=!1:document.getElementById("submit-button").disabled=!0}function validate_password_format(){var e=$("#password").val();e.length<21&&e.length>5&&e.search(pwdRule)!=-1?($("#validate-error-password-format").text(""),error_password_format=!1):(0==e.length?$("#validate-error-password-format").text(""):$("#validate-error-password-format").text("密碼格式不符"),error_password_format=!0),control_button()}function validate_password_same(){$(document).ready(function(){$("#password").keyup(check_pwd),$("#confirm-password").keyup(check_pwd),$("#token").keyup(check_pwd)})}function check_pwd(){var e=$("#password").val(),t=$("#confirm-password").val();e==t?($("#validate-error-password").text(""),error_password_same=!1):($("#validate-error-password").text("輸入密碼不相同"),error_password_same=!0),control_button()}var error_password_format=!0,error_password_same=!0;emailRule=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,pwdRule=/^.[A-Za-z0-9]+$/,jQuery(document).ajaxSend(function(e,t,r){function o(e){var t=null;if(document.cookie&&""!=document.cookie)for(var r=document.cookie.split(";"),o=0;o<r.length;o++){var a=jQuery.trim(r[o]);if(a.substring(0,e.length+1)==e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}function a(e){var t=document.location.host,r=document.location.protocol,o="//"+t,a=r+o;return e==a||e.slice(0,a.length+1)==a+"/"||e==o||e.slice(0,o.length+1)==o+"/"||!/^(\/\/|http:|https:).*/.test(e)}function n(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}!n(r.type)&&a(r.url)&&t.setRequestHeader("X-CSRFToken",o("csrftoken"))}),$("form").submit(function(e){e.preventDefault(),$.ajax({url:location.pathname,type:"POST",data:{new_password:$("input[name=new_password]").val(),confirm_new_password:$("input[name=confirm_new_password]").val(),entry_token:$("input[name=entry_token]").val()},dataType:"json",complete:function(e,t,r){200===e.status?(alert("密碼設置成功!"),window.location.href="/accounts/login/"):(document.getElementById("error").style.display="block",document.getElementById("error").innerHTML='<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>'+e.responseText.split('"')[3],document.getElementById("form-id").reset())}})});